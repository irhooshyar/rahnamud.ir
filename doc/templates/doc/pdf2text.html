<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="../../static/library/bootstrap.min-4.5.2.css">
    <link rel="stylesheet" type="text/css" href="../../static/library/bootstrap.min-5.1.2npm.css">

    <script src="../../static/js/jquery_351/jquery.min.js"></script>
    <script src="../../static/library/bootstrap-5.1.2.bundle.min.js"></script>

    <!--BS Icons -->
    <link rel="stylesheet" href="../../static/library/bootstrap-icons-1.3.0.css">
    <!-- Fontawesome Icons -->

    <link rel="stylesheet" href="../../static/library/fontawesome-5.10.0.all.css"  />
    <link rel="stylesheet" href="../../static/library/font-awesome.min-4.7.0.css">


    <!-- anychart modules -->
    <script src="../../static/library/anychart-8.10.0-core.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-graph.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-pie.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-exports.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-cartesian.min.js"></script>


    <!-- jsnetworkx -->
    <script src="https://d3js.org/d3.v3.js"></script>
    <script src="../../static/js/jsnetworkx.js"></script>


    <!-- Footable  -->
    <script src="../../static/js/footable/demo-rows.js"></script>
    <script src="../../static/js/footable/ie10-viewport-bug-workaround.js"></script>
    <script src="../../static/js/footable/footable.js"></script>
    <link href="../../static/styles/footable/footable.bootstrap.min.css" rel="stylesheet">
    <link href="../../static/styles/footable/docs.css" rel="stylesheet">
    <link href="../../static/styles/footable/FooTable.Glyphicons.css" rel="stylesheet">
    <link href="../../static/styles/footable/FooTable.FontAwesome.css" rel="stylesheet">

    <!-- Download Zip Files -->
    <script src="../../static/js/zipDownload/jszip.min.js"></script>
    <script src="../../static/js/zipDownload/FileSaver.min.js"></script>

    <link rel="stylesheet" href="../../static/styles/index.css">
    <link rel="stylesheet" href="../../static/styles/pdf2text.css">

    <link rel="stylesheet" type="text/css" href="../../static/library/jquerysctipttop.css">

    <!-- Intro Js -->
    <script src="../../static/library/intro.min-4.3.0.js"></script>
    <link rel="stylesheet" type="text/css" href="../../static/library/introjs.min-4.3.0.css">
    <link rel="stylesheet" type="text/css" href="../../static/library/introjs-rtl.min-4.3.0.css">
    <link rel="stylesheet" href="../../static/styles/user_guide_tour.css">

    <link rel="stylesheet" type="text/css" href="../../static/library/bootstrap.min-4.5.2.css">
    <script src="../../static/js/jquery_351/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="../../static/library/bootstrap.min-5.1.2npm.css">
    <link href="../../static/library/bootstrap-theme.min-3.3.6.css" rel="stylesheet">
    <script src="../../static/library/bootstrap-5.1.2.bundle.min.js"></script>

    <!--BS Icons -->
    <link rel="stylesheet" href="../../static/library/bootstrap-icons-1.3.0.css">
    <!-- Fontawesome Icons -->

    <link rel="stylesheet" href="../../static/library/fontawesome-5.10.0.all.css"  />
    <link rel="stylesheet" href="../../static/library/font-awesome.min-4.7.0.css">

    <!-- anychart modules -->
    <script src="../../static/library/anychart-8.10.0-core.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-cartesian.min.js"></script>

    <link href="../../static/styles/footable/footable.bootstrap.min.css" rel="stylesheet">

    <!-- Footable  -->
    <script src="../../static/js/footable/demo-rows.js"></script>
    <script src="../../static/js/footable/ie10-viewport-bug-workaround.js"></script>
    <script src="../../static/js/footable/footable.js"></script>
    <link href="../../static/styles/footable/footable.bootstrap.min.css" rel="stylesheet">
    <link href="../../static/styles/footable/docs.css" rel="stylesheet">
    <link href="../../static/styles/footable/FooTable.Glyphicons.css" rel="stylesheet">
    <link href="../../static/styles/footable/FooTable.FontAwesome.css" rel="stylesheet">

    <!-- Intro Js -->
    <script src="../../static/library/intro.min-4.3.0.js"></script>
    <link rel="stylesheet" type="text/css" href="../../static/library/introjs.min-4.3.0.css">
    <link rel="stylesheet" type="text/css" href="../../static/library/introjs-rtl.min-4.3.0.css">

    <link rel="stylesheet" href="../../static/styles/index.css">
    <link rel="stylesheet" href="../../static/styles/information_chart.css">
    <link rel="stylesheet" href="../../static/styles/user_guide_tour.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="../../static/library/bootstrap.min-4.5.2.css">
    <link rel="stylesheet" type="text/css" href="../../static/library/bootstrap.min-5.1.2npm.css">
    <link href="../../static/library/bootstrap-theme.min-3.3.6.css" rel="stylesheet">


    <script src="../../static/js/jquery_351/jquery.min.js"></script>
    <script src="../../static/library/bootstrap-5.1.2.bundle.min.js"></script>

    <!--BS Icons -->
    <link rel="stylesheet" href="../../static/library/bootstrap-icons-1.3.0.css">
    <!-- Fontawesome Icons -->

    <link rel="stylesheet" href="../../static/library/fontawesome-5.10.0.all.css"  />
    <link rel="stylesheet" href="../../static/library/font-awesome.min-4.7.0.css">


    <!-- anychart modules -->
    <script src="../../static/library/anychart-8.10.0-core.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-graph.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-pie.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-exports.min.js"></script>
    <script src="../../static/library/anychart-8.10.0-cartesian.min.js"></script>

    <!-- Footable  -->
    <script src="../../static/js/footable/demo-rows.js"></script>
    <script src="../../static/js/footable/ie10-viewport-bug-workaround.js"></script>
    <script src="../../static/js/footable/footable.js"></script>
    <link href="../../static/styles/footable/footable.bootstrap.min.css" rel="stylesheet">
    <link href="../../static/styles/footable/docs.css" rel="stylesheet">
    <link href="../../static/styles/footable/FooTable.Glyphicons.css" rel="stylesheet">
    <link href="../../static/styles/footable/FooTable.FontAwesome.css" rel="stylesheet">

    <link rel="stylesheet" href="../../static/styles/index2.css">
    <link rel="stylesheet" href="../../static/styles/search_chart.css">

    <link rel="stylesheet" type="text/css" href="../../static/library/jquerysctipttop.css">

    <!-- Intro Js -->
    <script src="../../static/library/intro.min-4.3.0.js"></script>
    <link rel="stylesheet" type="text/css" href="../../static/library/introjs.min-4.3.0.css">
    <link rel="stylesheet" type="text/css" href="../../static/library/introjs-rtl.min-4.3.0.css">
    <link rel="stylesheet" href="../../static/styles/user_guide_tour.css">

    <!--<script type="text/javascript" src="http://l2.io/ip.js?var=myip">
    </script>-->

    <meta charset="UTF-8">

    <title>تبدیل Pdf به متن</title>
    {% include "doc/title_icon.html" %}
</head>

<body>

    <!-- Menu -->
    <nav dir="rtl" class="navbar nav_menu navbar-expand-lg fixed-top p-0 mt-0">
        <div class="container-fluid pr-0 mx-0">
            <a class="navbar-brand mr-0 px-2" href="{% url 'index' %}" id="brand_name">
                <i id="brand_logo" class="bi bi-x-diamond-fill px-1" style="position: relative; top: -5px;"></i>
                هوش‌یار
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            {% include "doc/header.html" %}

        </div>
    </nav>

    <script>
        $(document).ready(function () {
            $('select#language').on('change', function (e) {

                let selected_language = this.value;
                let current_url = window.location.href;
                if (selected_language === 'England') {
                    let page_name = current_url.split('/')[3]
                    let requested_url = current_url.replace(page_name, 'en')
                    window.location = requested_url;
                } else if (selected_language === 'Russia') {
                    let page_name = current_url.split('/')[3]
                    let requested_url = current_url.replace(page_name, 'ru')
                    window.location = requested_url;
                }

            });
        });
    </script>
    <!-- End of Menu -->


    <!-- Main Container -->
    <div class="row flex-row-reverse px-0 py-5 px-md-5 py-md-5 m-0 mt-5">
        <!-- Form Fields -->
        <form action="" class="custom-control mx-auto needs-validation" id="pdf2text_form" enctype="multipart/form-data"
            method="post" novalidate>
            <div class="row flex-row-reverse mt-2 mx-auto">
                <!-- File Input -->

                <div class="col-12 col-lg-3 bg-light pb-0 pt-3">
                    <label class="text-right d-block w-100 bg-light float-right" style="direction: rtl;;">فایل
                        فشرده:</label>
                    <button type="button" id="file_input_btn" class="btn mb-0 p-1 d-block float-right"><i
                            class="bi bi-folder"></i> انتخاب فایل</button>
                    <span id="file_name" dir="rtl" class="mb-0 p-1 float-right text-center text-secondary">فایلی
                        انتخاب
                        نشده‌است</span>
                    <input type="file" name="ZippedPdfs" id="ZippedPdfs" class="d-none">
                </div>

                <div class="col-md-6 pt-3 col-12 col-lg-3 bg-light">
                    <label for="LanguageSelect" class=" text-right bg-light float-right"
                        style="direction: rtl;;">زبان:</label>
                    <select id="LanguageSelect" class="form-select text-right float-right" style="direction: rtl;">
                        <option selected value="English" class="text-right">انگلیسی</option>
                        <option value="Persian" class="text-right">فارسی</option>
                        <option disabled value="Russian" class="text-right text-secondary">روسی</option>
                    </select>

                </div>

                <div class="col-12 col-lg-3 bg-light pb-0 pt-3">
                    <label class="text-right d-block w-100 bg-light float-right" style="direction: rtl;;">شروع
                        تبدیل:</label>
                    <button type="button" id="process_btn" onclick="classListListener()" class="btn float-right">
                        <div class="spinner-border text-light" role="status">
                            <span class="sr-only">درحال جستجو ...</span>
                        </div>
                        پردازش
                    </button>
                </div>

                <div class="col-12 col-lg-3 bg-light pb-0 pt-3">
                    <label class="text-right d-block w-100 bg-light float-right" style="direction: rtl;;">دانلود
                        نتایج:</label>
                    <button type="button" disabled id="download_button" class="btn float-right">
                        <a href="#" id="download_result" download style="color: white">دانلود نتایج</a>
                    </button>
                </div>
            </div>
        </form>
    </div>



    <button id="scroll_btn" class="p-0" title="بالای صفحه" onclick="topFunction()">
        <i class="far fa-caret-square-up"></i>
        <!-- <i class="bi bi-chevron-up"></i> -->
        <!-- <i class="bi bi-chevron-double-up"></i> -->
        <!-- <i class="bi bi-arrow-up-circle"></i> -->
    </button>


    <script src="../../static/js/logincheck.js"></script>

    <script src="../../static/js/scroll_button_handler.js"></script>

    <script>
        $(document).ready(function () {

            $('#file_input_btn').on('click', function () {
                $('#ZippedPdfs').trigger('click');

            });

            $('#ZippedPdfs').change(function (e) {
                let fileName = e.target.files[0].name;
                $('span#file_name').text(fileName);
            });

        });
    </script>
    <script>
        async function classListListener() {
            const compressed_file_size = document.getElementById('ZippedPdfs').files.length
            if (compressed_file_size != 0) {
                let elem = document.getElementById('process_btn');
                let lastClasses = elem.classList.value;
                await SpinnerModeFunction('Active');
                window.setInterval(function () {
                    let classes = elem.classList.value;
                    if (classes !== lastClasses) {
                        Process();
                    }
                }, 10);
            }
        }
    </script>
    <script>
        async function Process() {
            let results_path = NaN;
            let form_data = new FormData();
            let compressed_path = await uploadCompressedPdfs()
            let language = document.getElementById('LanguageSelect').value
            form_data.append('compressed_path', compressed_path)
            form_data.append('language', language)
            $.ajax({
                url: 'http://' + location.host + '/DownloadPdfTexts/',
                data: form_data,
                type: 'POST',
                contentType: false,
                processData: false,
                async: false,
            }).done(function (res) {
                results_path = res['saved_path']
            }).fail(function (res) {
                console.log(res)
            });
            if (results_path) {
                await SpinnerModeFunction("Disable");
                results_path = String(results_path)
                const download_link = 'http://' + location.host + '/' + results_path.replace('media_cdn', 'media');
                document.getElementById("download_result").href = download_link;
            }
        }
    </script>
    <script>
        async function SpinnerModeFunction(mode) {
            if (mode === "Active") {
                document.getElementById("download_button").disabled = true;
                document.getElementById("process_btn").classList.add("d-flex");
                $(".spinner-border").addClass("active");
            } else if (mode === "Disable") {
                document.getElementById("download_button").disabled = false;
                document.getElementById("process_btn").classList.remove("d-flex");
                $(".spinner-border").removeClass("active");
            }
        }
    </script>
    <script>
        async function uploadCompressedPdfs() {
            let form_data = new FormData();
            let compressed_file = document.getElementById('ZippedPdfs').files[0];
            form_data.append('compressed_file', compressed_file);
            let link_request = 'http://' + location.host + '/UploadCompressedPdfs/';
            let compressed_path = NaN;
            /* Send Request */
            $.ajax({
                url: link_request,
                data: form_data,
                type: 'POST',
                contentType: false,
                processData: false,
                async: false,
                enctype: 'multipart/form-data',

            }).done(function (res) {
                compressed_path = res['saved_path']
            }).fail(function (res) {
                console.log(res)
            });
            return compressed_path;
        }
    </script>


</body>
<script src="../../static/js/UserLogSave.js"></script>
<script src="../../static/js/signout_function.js"></script>

<!-- Intro Js -->
<script src="../../static/js/pdf2text/pdf2text_tour.js">
</script>
<script src="../../static/js/tour.js"></script>

</html>